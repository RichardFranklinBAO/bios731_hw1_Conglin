# Cross-Sectional Momentum on S&P 500

This repo contains all code, data, and a Dockerized environment to reproduce a 12–1 cross-sectional momentum analysis on S&P 500 stocks.
You do not need local R—only Docker.

Docker Hub: richardfbao/d550-final-report:latest
Prebuilt Docker image on DockerHub: **https://hub.docker.com/r/richardfbao/d550-final-report**


## Repository Layout

```text
.
├─ data/
│  ├─ raw/all_stocks_5yr.csv
│  └─ clean/monthly_returns.csv
├─ R_Project.Rmd
├─ Dockerfile
├─ Makefile
└─ report/                  # created at runtime; contains R_Project.html
```


## One-command build of the report (Rubric-ready)

From the repo root, with Docker Desktop running:

`make report`

Output: report/R_Project.html

This target runs docker run and bind-mounts the local report/ directory into the container, so the compiled report is written back to your machine—exactly what the rubric requires for the Makefile + report generation points.

#### (Optional) Raw docker command
If you prefer not to use make, you can run:
```
docker run --rm \
  -v "$PWD":/work \
  -v "$PWD/report":/out \
  -w /work \
  -e OUTDIR=/out \
  richardfbao/d550-final-report:latest
```

## (Optional) Build the image locally

This satisfies the rubric “docker build README” item.
You can skip this step and use the prebuilt image from DockerHub.
If you want to build locally:

`make docker-build`

equivalent:
`docker build --platform=linux/amd64 -t richardfbao/d550-final-report:latest .`


## Makefile targets

* `make docker-build` -> Builds richardfbao/d550-final-report:latest locally (uses --platform=linux/amd64 for Apple Silicon compatibility).
* `make report` -> Generates ./report/R_Project.html (alias of docker-report).
* `make clean` -> Removes the local report/ directory.
* `make help` -> Prints target help.

Notes
	* Apple Silicon (M-series): already handled by --platform=linux/amd64 in the build recipe.
	* Windows (Git Bash): if a bind-mount path error occurs, change -v "$(PWD)" to -v "/$(PWD)" in the Makefile (some Git Bash setups need the leading slash).

## Why R is not required locally
The Docker image includes all system deps and R packages (rmarkdown, here, tidyverse, PerformanceAnalytics, xts, zoo, etc.). The container renders R_Project.Rmd and writes the HTML to your mounted report/ directory.

## TA quick check
```
# fresh clone
git clone https://github.com/RichardFranklinBAO/bios731_hw1_Conglin.git
cd bios731_hw1_Conglin

# render via Docker
make docker-build
make report

# verify artifact exists
test -f report/R_Project.html && echo "✅ report OK" || echo "❌ report missing"

Output: report/R_Project.pdf

Note: Files in `data/clean/` and `report/` are generated artifacts.
They can be safely removed using `make clean` and will be recreated when running `make report`.

```
## License
For course use and demonstration only.

## What each major file and folder in the project does
### code/

Contains all analysis scripts, organized by workflow stage. Each script loads its own required packages and is designed to be sourced from the main R Markdown file.

* 01_data_reading_cleaning.R
Reads the raw S&P 500 daily price data from data/raw/ using relative paths, performs basic cleaning (date parsing, ordering, and removal of missing values), aggregates daily prices into monthly log returns, and saves a tidy dataset to data/clean/monthly_returns.csv.
This script ensures that the analysis starts from raw data and produces a reproducible, analysis-ready dataset.

* 02_modeling.R
Constructs the 12–1 cross-sectional momentum signal based on past monthly returns, forms decile portfolios (long top decile, short bottom decile), computes the long–short return series, and applies a simple transaction cost adjustment.
It also fits a statistical model in the form of monthly cross-sectional regressions of returns on the momentum signal, producing summary statistics for the estimated coefficients.

* 03_visualization.R
Generates the main visualization used in the report: cumulative returns of the long–short momentum strategy, shown both gross and net of transaction costs.
The script produces a publication-quality ggplot object that is included in the final report.

* 01_render_report.R
A lightweight render script used primarily for automated or Docker-based runs. It calls rmarkdown::render() to compile R_Project.Rmd and write the final PDF output to the specified output directory.

### data/

Stores all data used in the analysis, separated into raw inputs and cleaned outputs.

### data/raw/
Contains the original dataset (all_stocks_5yr.csv) as obtained from Kaggle. These files are not modified and serve as the reproducible starting point of the analysis.

### data/clean/
Contains processed and cleaned data generated by the analysis pipeline, specifically the monthly return dataset (monthly_returns.csv) used for modeling and visualization.

### R_Project.Rmd

The main R Markdown file that produces the final report.
It describes the dataset and research question, explains the data cleaning process, presents the statistical models, includes visualizations, and summarizes the findings.
All computation is performed by sourcing the scripts in the code/ directory, ensuring a clean separation between narrative and analysis code.

### Dockerfile

Defines a fully reproducible computational environment using Docker.
It specifies the R version, system dependencies, LaTeX tools for PDF rendering, and required R packages, allowing the report to be built without relying on a local R installation.

### Makefile

Provides convenient commands to build the Docker image and generate the final report.
In particular, make report runs the complete analysis and renders the PDF into the report/ directory, enabling one-command reproducibility.

### renv/ and renv.lock

Used for R package dependency management.
The renv.lock file records exact package versions used in the analysis, ensuring that the same results can be reproduced across different machines and over time.

### report/

Contains the rendered output of the project (e.g., R_Project.pdf).
This directory is generated at runtime and holds the final report produced by knitting the R Markdown file.

## Session Information

The exact R version and package versions used are recorded in `renv.lock`.
For reference, a `sessionInfo()` output from a successful local run is shown below:

```text
R version 4.4.1 (2024-06-14)
Platform: aarch64-apple-darwin20
Running under: macOS 26.2

Matrix products: default
BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/New_York
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] scales_1.3.0               ggplot2_3.5.1              knitr_1.48                 PerformanceAnalytics_2.0.8
 [5] xts_0.14.1                 zoo_1.8-12                 slider_0.3.2               tidyr_1.3.1               
 [9] readr_2.1.5                dplyr_1.1.4                here_1.0.1                

loaded via a namespace (and not attached):
 [1] utf8_1.2.4        generics_0.1.3    renv_1.1.5        lattice_0.22-6    hms_1.1.3         digest_0.6.37    
 [7] magrittr_2.0.3    evaluate_0.24.0   grid_4.4.1        fastmap_1.2.0     rprojroot_2.0.4   tinytex_0.52     
[13] purrr_1.0.2       fansi_1.0.6       cli_3.6.3         rlang_1.1.4       crayon_1.5.3      bit64_4.5.2      
[19] munsell_0.5.1     withr_3.0.1       yaml_2.3.10       tools_4.4.1       parallel_4.4.1    tzdb_0.4.0       
[25] colorspace_2.1-1  vctrs_0.6.5       R6_2.5.1          lifecycle_1.0.4   bit_4.5.0         vroom_1.6.5      
[31] pkgconfig_2.0.3   warp_0.2.1        pillar_1.9.0      gtable_0.3.5      rsconnect_1.3.3   glue_1.8.0       
[37] xfun_0.47         tibble_3.2.1      tidyselect_1.2.1  highr_0.11        rstudioapi_0.16.0 farver_2.1.2     
[43] htmltools_0.5.8.1 rmarkdown_2.28    labeling_0.4.3    compiler_4.4.1    quadprog_1.5-8   

